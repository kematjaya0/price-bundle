{% block money_widget -%}
    {{- block('price_stylesheet') -}}
    {% set prepend = not (money_pattern starts with '{{') %}
    {% set append = not (money_pattern ends with '}}') %}
    {% if prepend or append %}
        <div class="input-group">
            {% if prepend %}
                <span class="input-group-addon currency-code">{{ money_pattern|form_encode_currency }}</span>
            {% endif %}
            {{- block('form_widget_simple') -}}
            {% if append %}
                <span class="input-group-addon currency-code">{{ money_pattern|form_encode_currency }}</span>
            {% endif %}
        </div>
    {% else %}
        {{- block('form_widget_simple') -}}
    {% endif %}

    <div id="{{ id }}_js"></div>
    {{- block('price_javascript') -}}

{%- endblock money_widget %}

{% block price_stylesheet %}
    <style>
        #{{ id }} {
            text-align: right;
        }
    </style>
{% endblock %}

{% block price_javascript %}
    <script>

        (function() {
            if (typeof $('#{{ id }}').priceFormat !== "function") {
                let scriptEle = document.createElement("script");
                scriptEle.setAttribute("src", "{{ asset('bundles/price/js/jquery.priceFormat.min.js') }}");
                document.getElementById('{{ id }}_js').appendChild(scriptEle);
                scriptEle.addEventListener("load", () => {
                    priceFormat{{ id|capitalize }}();
                });
                return;
            } else {
                priceFormat{{ id|capitalize }}();
            }
        })();

        function priceFormat{{ name|capitalize }}() {
            priceFormat{{ id|capitalize }}();
            console.warn("contact your developer, function 'priceFormat{{ name|capitalize }}()' is deprecated, use 'priceFormat{{ id|capitalize }}()' instead");
        }

        function priceFormat{{ id|capitalize }}() {
            if (!window.jQuery) {
                return;
            }

            generateCentNumber{{ id|capitalize }}();

            format{{ id|capitalize }}();
        }

        function format{{ id|capitalize }}() {
            refreshPriceDOM('#{{ id }}');
        }

        function generateCentNumber{{ id|capitalize }}() {
            generateCentNumber('#{{ id }}');
        }

    </script>
{% endblock %}